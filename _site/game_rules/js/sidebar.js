const KipukasSidebar=(()=>{let d=[],c=[],a=null;function o(e){const t=document.getElementById("toc");t.innerHTML="",d=[],c=[],e.forEach(n=>{const s=document.createElement("a");s.href=`#${n.id}`,s.textContent=n.text,s.className=`toc-link${n.level===3?" toc-sub":""}`,s.dataset.targetId=n.id,s.addEventListener("click",g=>{g.preventDefault(),scrollContentTo(n.id),history.replaceState(null,"",`#${n.id}`),window.innerWidth<1024&&l()}),t.appendChild(s),d.push(s),c.push(n.element)}),r()}function r(){a&&a.disconnect();const e=document.getElementById("content-scroll");a=new IntersectionObserver(t=>{t.forEach(n=>{n.isIntersecting&&u(n.target.id)})},{root:e,rootMargin:"-10% 0px -80% 0px",threshold:0}),c.forEach(t=>a.observe(t))}function u(e){d.forEach(t=>{t.dataset.targetId===e?(t.classList.add("active"),t.scrollIntoView({block:"nearest",behavior:"smooth"})):t.classList.remove("active")})}function i(){const e=document.getElementById("sidebar"),t=document.getElementById("sidebar-overlay");e.classList.remove("-translate-x-full"),t.classList.remove("hidden")}function l(){const e=document.getElementById("sidebar"),t=document.getElementById("sidebar-overlay");e.classList.add("-translate-x-full"),t.classList.add("hidden")}function f(){const e=document.getElementById("sidebar");e.classList.contains("-translate-x-full")?i():window.innerWidth>=1024?(e.classList.add("-translate-x-full"),e.classList.remove("lg:translate-x-0"),e.classList.add("lg:-translate-x-full")):l()}function m(){const e=document.getElementById("sidebar-toggle"),t=document.getElementById("sidebar-close"),n=document.getElementById("sidebar-overlay");e.addEventListener("click",()=>{const s=document.getElementById("sidebar");window.innerWidth>=1024?s.classList.contains("lg:-translate-x-full")?(s.classList.remove("lg:-translate-x-full"),s.classList.add("lg:translate-x-0")):(s.classList.add("lg:-translate-x-full"),s.classList.remove("lg:translate-x-0")):s.classList.contains("-translate-x-full")?i():l()}),t.addEventListener("click",l),n.addEventListener("click",l)}return{buildTOC:o,initToggle:m}})();
