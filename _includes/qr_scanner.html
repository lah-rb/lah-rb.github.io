<!-- Modal for getting camera permission -->
{% capture message %}
  By allowing camera access to our QR code scanner, you agree to our
  <a href="/privacy_policy" class="text-kip-red hover:text-emerald-600 underline" @click="showModal = false">privacy policy</a>.
  Breath easy, we don't collect any data.
{% endcapture %}

{% include modal.html 
  showCriteria='showQRModal' 
  modalTitle='Privacy Notice' 
  modalMessage=message 
  acceptButtonText='Accept & Continue'
  acceptClick='acceptPrivacy = true; noCamera = false; showQRModal = false; showScanner = false'
  denyButtonText="Don't Need It"
  denyClick='noCamera = true; showQRModal = false; showScanner = false;'
%}
<!-- Video for scanning QRs -->
<canvas x-cloak id="canvas" class="-z-10 fixed -translate-x-1/2 -translate-y-1/2 scale-x-[-1] top-1/2 left-1/2 hidden"
  width="640" height="480">
</canvas>
<video x-cloak id="video"
  class="z-30 fixed w-80 lg:w-1/3 -translate-x-1/2 -translate-y-1/2 scale-x-[-1] top-1/2 left-1/2 rounded-lg transition delay-150"
  x-show="showScanner && !noCamera && videoReady">
</video>
<!-- Button to toggle scanning code and video -->
<button aria-label="Toggle QR Scanner" class="{{ include.buttonClass }}">
  <svg xmlns="http://www.w3.org/2000/svg"
    @click="{{ site.data.templates.qr-click }}"
    viewBox="0 0 128 128" alt="QR Scanner Toggle"
    class="{{ include.svgClass }}" {{ include.classBinder }}>
    <path
      d="M306.692 182.753a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-16a2 2 0 0 0-2-2zm4 4h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2zM276.692 152.753a2.003 2.003 0 0 0-2 2v24a2.003 2.003 0 0 0 2 2h24a2.003 2.003 0 0 0 2-2v-24a2.003 2.003 0 0 0-2-2zm4 4h16a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2h-16a2 2 0 0 1-2-2v-16a2 2 0 0 1 2-2zm4 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2zM306.692 152.753a2.003 2.003 0 0 0-2 2v24a2.003 2.003 0 0 0 2 2h24a2.003 2.003 0 0 0 2-2v-24a2.003 2.003 0 0 0-2-2zm4 4h16a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2h-16a2 2 0 0 1-2-2v-16a2 2 0 0 1 2-2zm4 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2zM276.692 182.753a2.003 2.003 0 0 0-2 2v24a2.003 2.003 0 0 0 2 2h24a2.003 2.003 0 0 0 2-2v-24a2.003 2.003 0 0 0-2-2zm4 4h16a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2h-16a2 2 0 0 1-2-2v-16a2 2 0 0 1 2-2zm4 4a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2z"
      transform="matrix(2.2069 0 0 2.2069 -606.216 -337.109)"/>
  </svg>
</button>
<!-- Script for scanning QRs in canvas -->
<script defer src="/assets/js-wasm/qr_scanner.js"></script>

