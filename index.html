---
layout: default
permalink: /
title: "Binder Home"
description: "This is the home of all the cards ever produced by Kipukas! Whether
you are planning you next dominating game strategy or browsing for lovely pieces of
art you came to the right place."
bg-terra: "bg-hero-pattern "
---

{% include toolbar.html 
  qr_scanner=true 
  type_matchup=true
  lastPage=true
  hamburger=true
  filter=true
  turn_tracker=true
  install_pwa=true
  logo=true
  hideTools=true
  search=true
  base_fill='fill-kip-goldenrod'
  base_stroke='stroke-kip-goldenrod'
  background_color='bg-slate-100/80'
%}

<!-- Card grid: HTMX infinite scroll powered by WASM /api/cards -->
<div id="card-grid"
  class="flex flex-wrap gap-x-5 content-auto place-content-center"
  hx-get="/api/cards?page=0&per=12&all=true"
  hx-trigger="load"
  hx-swap="innerHTML swap:150ms">
</div>

<script>
  // Called by filter checkboxes and search input to refresh the card grid.
  // Reads Alpine reactive state, builds query string, calls htmx.ajax()
  // through the same WASM bridge path (Phase 2 lesson #4).
  window.kipukasRefreshCards = function() {
    if (typeof Alpine === 'undefined' || typeof htmx === 'undefined') return;

    var data = Alpine.$data(document.body);
    var filter = data.filter || {};
    var search = (data.searchQuery || '').trim();

    var params = ['page=0', 'per=12'];

    if (search) {
      // Search mode: search across all cards regardless of filters
      params.push('search=' + encodeURIComponent(search));
    } else if (filter.all) {
      // Show All mode
      params.push('all=true');
    } else {
      // Filter mode: collect active filter keys
      var active = [];
      var keys = Object.keys(filter);
      for (var i = 0; i < keys.length; i++) {
        if (keys[i] !== 'all' && filter[keys[i]] === true) {
          active.push(keys[i]);
        }
      }
      if (active.length > 0) {
        params.push('filter=' + encodeURIComponent(active.join(',')));
      }
      // If no active filters, params has no filter/all/search â†’ WASM returns empty grid
    }

    var url = '/api/cards?' + params.join('&');
    htmx.ajax('GET', url, {target: '#card-grid', swap: 'innerHTML swap:150ms'});
  };
</script>
